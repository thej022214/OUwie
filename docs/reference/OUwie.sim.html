<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generalized Hansen model simulator — OUwie.sim • OUwie</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Hansen model simulator — OUwie.sim"><meta property="og:description" content="Simulates the Ornstein-Uhlenbeck process of continuous characters evolving under discrete selective regimes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OUwie</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/hOUwieStarterGuide.html">hOUwie User Guide</a>
    </li>
    <li>
      <a href="../articles/OUwie_2.1_adds.html">New additions as of OUwie 2.1</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thej022214/OUwie/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized Hansen model simulator</h1>

    <div class="hidden name"><code>OUwie.sim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates the Ornstein-Uhlenbeck process of continuous characters evolving under discrete selective regimes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">OUwie.sim</span><span class="op">(</span>phy<span class="op">=</span><span class="cn">NULL</span>, data<span class="op">=</span><span class="cn">NULL</span>, simmap.tree<span class="op">=</span><span class="cn">FALSE</span>, root.age<span class="op">=</span><span class="cn">NULL</span>, scaleHeight<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>alpha<span class="op">=</span><span class="cn">NULL</span>, sigma.sq<span class="op">=</span><span class="cn">NULL</span>, theta0<span class="op">=</span><span class="cn">NULL</span>, theta<span class="op">=</span><span class="cn">NULL</span>, tip.fog<span class="op">=</span><span class="st">"none"</span>, shift.point<span class="op">=</span><span class="fl">0.5</span>, </span>
<span>fitted.object<span class="op">=</span><span class="cn">NULL</span>, get.all<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>a phylogenetic tree, in <code>ape</code> “phylo” format and with internal nodes labeled denoting the ancestral selective regimes</p></dd>

<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a dataframe containing species information (see Details). Not necessary to include if <code>simmap=TRUE</code>.</p></dd>

<dt id="arg-simmap-tree">simmap.tree<a class="anchor" aria-label="anchor" href="#arg-simmap-tree"></a></dt>
<dd><p>a logical indicating whether the input tree is in SIMMAP format. The default is <code>FALSE</code>.</p></dd>

<dt id="arg-root-age">root.age<a class="anchor" aria-label="anchor" href="#arg-root-age"></a></dt>
<dd><p>indicates the age of the tree. This is to be used in cases where the "tips" are not contemporary, such as in cases for fossil trees. Default is <code>NULL</code> meaning latest tip is modern day.</p></dd>

<dt id="arg-scaleheight">scaleHeight<a class="anchor" aria-label="anchor" href="#arg-scaleheight"></a></dt>
<dd><p>a logical indicating whether the total tree height should be scaled to 1 (see Details). The default is <code>FALSE</code>.</p></dd>

<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>a numeric vector giving the values of \(\alpha\) for each selective regime (see Details)</p></dd>

<dt id="arg-sigma-sq">sigma.sq<a class="anchor" aria-label="anchor" href="#arg-sigma-sq"></a></dt>
<dd><p>a numeric vector giving the values of \(\sigma^2\) for each selective regime (see Details)</p></dd>

<dt id="arg-theta-">theta0<a class="anchor" aria-label="anchor" href="#arg-theta-"></a></dt>
<dd><p>a numeric indicating the starting state, \(\theta_0\)</p></dd>

<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>a numeric vector giving the values of \(\theta\) for each selective regime (see Details)</p></dd>

<dt id="arg-tip-fog">tip.fog<a class="anchor" aria-label="anchor" href="#arg-tip-fog"></a></dt>
<dd><p>designates whether a third column in the data matrix contains tip fog for each species value ("known"). The tip fog is assumed to be the standard error of the species mean. The default is "none".</p></dd>

<dt id="arg-shift-point">shift.point<a class="anchor" aria-label="anchor" href="#arg-shift-point"></a></dt>
<dd><p>the point along a branch where a regime change is assumed to have occurred (if <code>SIMMAP=FALSE</code>. The default is set to 0.5, or halfway along a branch.</p></dd>

<dt id="arg-fitted-object">fitted.object<a class="anchor" aria-label="anchor" href="#arg-fitted-object"></a></dt>
<dd><p>a model fit from OUwie to use for simulation.</p></dd>

<dt id="arg-get-all">get.all<a class="anchor" aria-label="anchor" href="#arg-get-all"></a></dt>
<dd><p>a logical indicating whether or not the entire simulation history is to be returned. The default is <code>FALSE</code> meaning that only the tips are returned.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The input is a tree and a data file OR a fitted OUwie object. The tree must be of class “phylo” and if <code>simmap=FALSE</code> must contain the ancestral selective regimes as internal node labels. The data file is a dataframe that must have column entries in the following order: [,1] species names and [,2] their current selective regime. If <code>tip.fog="known"</code> then a third column can be added which contains the tip fog for each species. Note that if <code>simmap=TRUE</code> no data file is needed. The user specifies the simulated parameter values (i.e. \(\alpha\), \(\sigma^2\), \(\theta_0\), \(\theta\)). Assuming two selective regimes, possible models can be specified as follows (Note that this assumes a stationary distribution at the root):</p>
<p>a. Single rate Brownian motion (<code>BM1</code>): alpha=c(1e-10,1e-10); sigma.sq=c(0.45,0.45); theta0=1.0; theta=c(0,0).</p>
<p>b. Brownian motion with different rate parameters for each state on a tree (<code>BMS</code>): alpha=c(1e-10,1e-10) sigma.sq=c(0.45,0.90); theta0=1.0; theta=c(0,0).</p>
<p>c. Ornstein Uhlenbeck with a single optimum for all species (<code>OU1</code>): alpha=c(0.1,0.1); sigma.sq=c(0.9,0.9); theta0=1; theta=c(1.0,1.0).</p>
<p>d. Ornstein Uhlenbeck model that assumes different state means and a single \(\alpha\) and \(\sigma^2\) (<code>OUM</code>): alpha=c(1.0,1.0); sigma.sq=c(0.45,0.45); theta0=1.0; theta=c(1.0,2.0).</p>
<p>e. Ornstein Uhlenbeck model that assumes different state means and multiple \(\sigma^2\) (<code>OUMV</code>): alpha=c(1.0,1.0); sigma.sq=c(0.45,0.90); theta0=1.0; theta=c(1.0,2.0).</p>
<p>f. Ornstein Uhlenbeck model that assumes different state means and multiple \(\alpha\) (<code>OUMA</code>): alpha=c(1.0,0.5); sigma.sq=c(0.45,0.45); theta0=1.0; theta=c(1.0,2.0).</p>
<p>g. Ornstein Uhlenbeck model that assumes different state means and multiple \(\sigma^2\) and \(\alpha\) (<code>OUMVA</code>): alpha=c(1.0,0.5); sigma.sq=c(0.45,0.9); theta0=1.0; theta=c(1.0,2.0).</p>
<p>With a fitted OUwie model, it just uses the parameters from that, ignoring any alpha, theta, etc. set in the function.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A dataframe containing, as column entries, [,1] species names, [,2] current regime, [,3] simulated continuous trait, x.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeremy M. Beaulieu and Brian C. O'Meara</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim.ex</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Simulate an Ornstein-Uhlenbeck model with different state means</span></span></span>
<span class="r-in"><span><span class="co">#and a separate alpha and sigma^2 per selective regime</span></span></span>
<span class="r-in"><span><span class="va">alpha</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma.sq</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta0</span><span class="op">=</span><span class="fl">1.0</span></span></span>
<span class="r-in"><span><span class="va">theta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">2.0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim.data</span><span class="op">&lt;-</span><span class="fu">OUwie.sim</span><span class="op">(</span><span class="va">tree</span>,<span class="va">trait</span>,simmap.tree<span class="op">=</span><span class="cn">FALSE</span>,scaleHeight<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>alpha<span class="op">=</span><span class="va">alpha</span>,sigma.sq<span class="op">=</span><span class="va">sigma.sq</span>,theta0<span class="op">=</span><span class="va">theta0</span>,theta<span class="op">=</span><span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Now fit a model to this and simulate from the fitted results</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="OUwie.html">OUwie</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">sim.data</span>, model<span class="op">=</span><span class="st">"OUMVA"</span>, simmap.tree<span class="op">=</span><span class="cn">FALSE</span>,scaleHeight<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>An algorithm was not specified. Defaulting to computing the determinant and inversion of the vcv.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The supplied regime painting may be unidentifiable for the regime painting. All regimes form connected subtrees.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Begin thorough search... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Summarizing results. </span>
<span class="r-in"><span><span class="va">sim.data.2</span> <span class="op">&lt;-</span> <span class="fu">OUwie.sim</span><span class="op">(</span>fitted.object<span class="op">=</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

