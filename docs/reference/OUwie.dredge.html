<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generalized Detection of shifts in OU process — OUwie.dredge • OUwie</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Detection of shifts in OU process — OUwie.dredge"><meta property="og:description" content="Allows the hypothesis free detection of shifts in the OU process. The number and location of shifts is estimated using a user-specified information criterion."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OUwie</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/hOUwieStarterGuide.html">hOUwie User Guide</a>
    </li>
    <li>
      <a href="../articles/OUwie_2.1_adds.html">New additions as of OUwie 2.1</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thej022214/OUwie/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized Detection of shifts in OU process</h1>

    <div class="hidden name"><code>OUwie.dredge.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Allows the hypothesis free detection of shifts in the OU process. The number and location of shifts is estimated using a user-specified information criterion.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">OUwie.dredge</span><span class="op">(</span><span class="va">phy</span>, <span class="va">data</span>, criterion<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"AICc"</span>, <span class="st">"BIC"</span>, <span class="st">"mBIC"</span><span class="op">)</span>, shift.max<span class="op">=</span><span class="fl">3</span>, </span>
<span>sigma.sq.max.k<span class="op">=</span><span class="fl">3</span>, alpha.max.k<span class="op">=</span><span class="fl">3</span>, root.age<span class="op">=</span><span class="cn">NULL</span>, scaleHeight<span class="op">=</span><span class="cn">FALSE</span>, root.station<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>shift.point<span class="op">=</span><span class="fl">0.5</span>, tip.fog<span class="op">=</span><span class="st">"none"</span>, algorithm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"invert"</span>, <span class="st">"three.point"</span><span class="op">)</span>, lb<span class="op">=</span><span class="cn">NULL</span>, ub<span class="op">=</span><span class="cn">NULL</span>, </span>
<span>opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"algorithm"</span><span class="op">=</span><span class="st">"NLOPT_LN_SBPLX"</span>, <span class="st">"maxeval"</span><span class="op">=</span><span class="st">"1000"</span>, </span>
<span><span class="st">"ftol_rel"</span><span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>a phylogenetic tree, in <code>ape</code> “phylo” format and with internal nodes labeled denoting the ancestral selective regimes</p></dd>

<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a dataframe containing two columns, taxon names in the first column, and species trait information in the second column.</p></dd>

<dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>information criterion to use for shift detection.</p></dd>

<dt id="arg-shift-max">shift.max<a class="anchor" aria-label="anchor" href="#arg-shift-max"></a></dt>
<dd><p>maximum allowed number of shifts.</p></dd>

<dt id="arg-sigma-sq-max-k">sigma.sq.max.k<a class="anchor" aria-label="anchor" href="#arg-sigma-sq-max-k"></a></dt>
<dd><p>maximum allowed number of sigma.sq parameters.</p></dd>

<dt id="arg-alpha-max-k">alpha.max.k<a class="anchor" aria-label="anchor" href="#arg-alpha-max-k"></a></dt>
<dd><p>maximum allowed number of alpha parameters.</p></dd>

<dt id="arg-root-age">root.age<a class="anchor" aria-label="anchor" href="#arg-root-age"></a></dt>
<dd><p>indicates the age of the tree. This is to be used in cases where the "tips" are not contemporary, such as in cases for fossil trees. Default is <code>NULL</code> meaning latest tip is modern day.</p></dd>

<dt id="arg-scaleheight">scaleHeight<a class="anchor" aria-label="anchor" href="#arg-scaleheight"></a></dt>
<dd><p>a logical indicating whether the total tree height should be scaled to 1. The default is <code>FALSE</code>.</p></dd>

<dt id="arg-root-station">root.station<a class="anchor" aria-label="anchor" href="#arg-root-station"></a></dt>
<dd><p>a logical indicating whether the starting state, \(\theta_0\), should be estimated.</p></dd>

<dt id="arg-shift-point">shift.point<a class="anchor" aria-label="anchor" href="#arg-shift-point"></a></dt>
<dd><p>the point along a branch where a regime change is assumed to have occurred (if <code>SIMMAP=FALSE</code>. The default is set to 0.5, or halfway along a branch.</p></dd>

<dt id="arg-tip-fog">tip.fog<a class="anchor" aria-label="anchor" href="#arg-tip-fog"></a></dt>
<dd><p>designates whether a fourth column in the data matrix contains tip fog for each species value ("known"). The tip fog is assumed to be the standard error of the species mean. The default is "none".</p></dd>

<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>designates whether the standard matrix inversion ('invert') or the faster 'three-point' algorithm of Ho and Ane (2013) should be used.</p></dd>

<dt id="arg-lb">lb<a class="anchor" aria-label="anchor" href="#arg-lb"></a></dt>
<dd><p>if algorithm == "invert" a single value indicating the lower bound for the parameter values. if algorithm == "three.point", a vector of length 3 with position 1 as alpha lower bound, position 2 as sigma.sq's lower bound, position 3 as theta's lower bound. when set to NULL it will be a default value of 1e-9. Note that even if the model you're using doesn't include alpha (e.g. BM1), it must be included in this vector, but it will not be used to set any bounds.</p></dd>

<dt id="arg-ub">ub<a class="anchor" aria-label="anchor" href="#arg-ub"></a></dt>
<dd><p>if algorithm == "invert" a single value indicating the upper bound for the parameter values. if algorithm == "three.point", a vector of length 3 with position 1 as alpha upper bound, position 2 as sigma.sq's upper bound, position 3 as theta's upper bound. when set to NULL it will be a default value of 100. Note that even if the model you're using doesn't include alpha (e.g. BM1), it must be included in this vector, but it will not be used to set any bounds.</p></dd>

<dt id="arg-opts">opts<a class="anchor" aria-label="anchor" href="#arg-opts"></a></dt>
<dd><p>a list of options to pass to nloptr for the optimization: useful to adjust for faster, coarser searches</p></dd>

<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>a logical indicating whether to print incremental steps</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This is an expanded version of the shift point model of Ho and Ane (2014). This is currently being tested, but as of now we strongly recommend using the mBIC criterion when searching for shifts.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>OUwie.dredge</code> returns an object of class <code>OUwie.dredge</code>. This is a list with elements:</p>
<dl><dt>$loglik</dt>
<dd><p>the maximum log-likelihood.</p></dd>

<dt>$criterion</dt>
<dd><p>the information criterion to use for shift detection.</p></dd>

<dt>$criterion.score</dt>
<dd><p>the information criterion score used for shift detection.</p></dd>

<dt>$shift.model</dt>
<dd><p>The shift model estimated from the data.</p></dd>

<dt>$solution</dt>
<dd><p>a matrix containing the maximum likelihood estimates of \(\alpha\) and \(\sigma^2\).</p></dd>

<dt>$tip.fog.est</dt>
<dd><p>indicates value of the measurement error if it was estimated from the data.</p></dd>

<dt>$theta</dt>
<dd><p>a matrix containing the maximum likelihood estimates of \(\theta\).</p></dd>

<dt>$tot.states</dt>
<dd><p>A vector of names for the different regimes</p></dd>

<dt>$index.mat</dt>
<dd><p>The indices of the parameters being estimated are returned. The numbers correspond to the row in the <code>eigvect</code> and can useful for identifying the parameters that are causing the objective function to be at a saddlepoint (see Details)</p></dd>

<dt>$simmap.tree</dt>
<dd><p>A logical indicating whether the input phylogeny is a SIMMAP formatted tree.</p></dd>

<dt>$root.age</dt>
<dd><p>The user-supplied age at the root of the tree.</p></dd>

<dt>$scaleHeight</dt>
<dd><p>Indicates whether the tree was constrained to a total height of 1.</p></dd>

<dt>$shift.point</dt>
<dd><p>The user-specified portion of the branch where a regime shift occurs.</p></dd>

<dt>$opts</dt>
<dd><p>Settings used for optimization routine.</p></dd>

<dt>$data</dt>
<dd><p>The shift model dataset, which includes regime painting for each tip.</p></dd>

<dt>$phy</dt>
<dd><p>The shift model painted phylogeny.</p></dd>

<dt>$root.station</dt>
<dd><p>A logical indicating whether the starting state, \(\theta_0\), was estimated</p></dd>

<dt>$starting.vals</dt>
<dd><p>the starting values used for the parameter search.</p></dd>

<dt>$regime.weights</dt>
<dd><p>A table containing parameter estimates and the weights for time spent in each regime for each tip.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Ho, L.S.T., and C. Ane. 2014. Intrinsic inference difficulties for trait evolution with Ornstein-Uhlenbeck models. Methods in Ecology and Evolution, 5: 1133-1146.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeremy M. Beaulieu</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

