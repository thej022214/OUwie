<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parametric bootstrap function — OUwie.boot • OUwie</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Parametric bootstrap function — OUwie.boot"><meta property="og:description" content="A function that performs a parametric bootstrap for a set of user-specified model parameters"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OUwie</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/hOUwieStarterGuide.html">hOUwie User Guide</a>
    </li>
    <li>
      <a href="../articles/OUwie_2.1_adds.html">New additions as of OUwie 2.1</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thej022214/OUwie/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parametric bootstrap function</h1>

    <div class="hidden name"><code>OUwie.boot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function that performs a parametric bootstrap for a set of user-specified model parameters</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">OUwie.boot</span><span class="op">(</span><span class="va">phy</span>, <span class="va">data</span>, model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BM1"</span>,<span class="st">"BMS"</span>,<span class="st">"OU1"</span>,<span class="st">"OUM"</span>,<span class="st">"OUMV"</span>,<span class="st">"OUMA"</span>,<span class="st">"OUMVA"</span><span class="op">)</span>,</span>
<span> nboot<span class="op">=</span><span class="fl">100</span>, <span class="va">alpha</span>, <span class="va">sigma.sq</span>, <span class="va">theta</span>, <span class="va">theta0</span>, simmap.tree<span class="op">=</span><span class="cn">FALSE</span>, root.age<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> scaleHeight<span class="op">=</span><span class="cn">FALSE</span>, root.station<span class="op">=</span><span class="cn">FALSE</span>, get.root.theta<span class="op">=</span><span class="cn">FALSE</span>, shift.point<span class="op">=</span><span class="fl">0.5</span>, </span>
<span> clade<span class="op">=</span><span class="cn">NULL</span>, tip.fog<span class="op">=</span><span class="st">"none"</span>, algorithm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"invert"</span>, <span class="st">"three.point"</span><span class="op">)</span>, </span>
<span> diagn<span class="op">=</span><span class="cn">FALSE</span>, quiet<span class="op">=</span><span class="cn">TRUE</span>, warn<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>a phylogenetic tree, in <code>ape</code> “phylo” format and with internal nodes labeled denoting the ancestral selective regimes.</p></dd>

<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data matrix containing species information.</p></dd>

<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>models to fit to comparative data.</p></dd>

<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>The number of bootstrap replicates.</p></dd>

<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>a numeric vector giving the values of \(\alpha\) for each selective regime.</p></dd>

<dt id="arg-sigma-sq">sigma.sq<a class="anchor" aria-label="anchor" href="#arg-sigma-sq"></a></dt>
<dd><p>a numeric vector giving the values of \(\sigma^2\) for each selective regime.</p></dd>

<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>a numeric vector giving the values of \(\theta\) for each selective regime.</p></dd>

<dt id="arg-theta-">theta0<a class="anchor" aria-label="anchor" href="#arg-theta-"></a></dt>
<dd><p>a numeric indicating the starting state, \(\theta_0\)</p></dd>

<dt id="arg-simmap-tree">simmap.tree<a class="anchor" aria-label="anchor" href="#arg-simmap-tree"></a></dt>
<dd><p>a logical indicating whether the input tree is in SIMMAP format. The default is <code>FALSE</code>.</p></dd>

<dt id="arg-root-age">root.age<a class="anchor" aria-label="anchor" href="#arg-root-age"></a></dt>
<dd><p>indicates the age of the tree. This is to be used in cases where the "tips" are not contemporary, such as in cases for fossil trees. Default is <code>NULL</code> meaning latest tip is modern day.</p></dd>

<dt id="arg-get-root-theta">get.root.theta<a class="anchor" aria-label="anchor" href="#arg-get-root-theta"></a></dt>
<dd><p>a logical indicating whether the starting state, \(\theta_0\), should be estimated (see Details).</p></dd>

<dt id="arg-scaleheight">scaleHeight<a class="anchor" aria-label="anchor" href="#arg-scaleheight"></a></dt>
<dd><p>a logical indicating whether the total tree height should be scaled to 1 (see Details). The default is <code>FALSE</code>.</p></dd>

<dt id="arg-root-station">root.station<a class="anchor" aria-label="anchor" href="#arg-root-station"></a></dt>
<dd><p>a logical indicating whether the starting state, \(\theta_0\), should be estimated (see Details).</p></dd>

<dt id="arg-shift-point">shift.point<a class="anchor" aria-label="anchor" href="#arg-shift-point"></a></dt>
<dd><p>the point along a branch where a regime change is assumed to have occurred (if <code>SIMMAP=FALSE</code>. The default is set to 0.5, or halfway along a branch.</p></dd>

<dt id="arg-clade">clade<a class="anchor" aria-label="anchor" href="#arg-clade"></a></dt>
<dd><p>a list containing a pair of taxa whose MRCA is the clade of interest.</p></dd>

<dt id="arg-tip-fog">tip.fog<a class="anchor" aria-label="anchor" href="#arg-tip-fog"></a></dt>
<dd><p>designates whether a fourth column in the data matrix contains tip fog for each species value ("known"). The tip fog is assumed to be the standard error of the species mean. The default is "none".</p></dd>

<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>designates whether the standard matrix inversion ('invert') or the faster 'three-point' algorithm of Ho and Ane (2013) should be used.</p></dd>

<dt id="arg-diagn">diagn<a class="anchor" aria-label="anchor" href="#arg-diagn"></a></dt>
<dd><p>a logical indicating whether the full diagnostic analysis should be carried out. The default is <code>FALSE</code>.</p></dd>

<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>a logical indicating whether progress should be written to the screen. The default is <code>TRUE</code>.</p></dd>

<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>a logical indicating whether a warning should be printed if the number of parameters exceeds ntips/10. The default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>


<p>A simple function for conducting a parametric bootstrap on parameters estimated in OUwie. As before, the input is a tree and a data file. The tree must be of class “phylo” and if <code>simmap=FALSE</code> must contain the ancestral selective regimes as internal node labels. The data file is a dataframe that must have column entries in the following order: [,1] species names and [,2] their current selective regime. The user specifies the simulated parameter values (i.e. \(\alpha\), \(\sigma^2\), \(\theta_0\), \(\theta\)), which is assumed to be the maximum likelihood estimates obtained from an OUwie run.</p>
<p>Note that if <code>root.station</code> is <code>TRUE</code> (the default), \(\theta_0\) was dropped from the model. In this case, then, \(\theta_0\) should be set to the value of the selective regime mapped at the root (i.e., state 1 in the “tworegime” example dataset).</p>
    </div>
    <div id="value">
    <h2>Value</h2>


<p><code>OUwie.boot</code> returns an object of class <code>OUwie.boot</code>. This is a matrix of column length equal to the number of parameters, and row length of the number of bootstrap replicates specified.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Beaulieu J.M., Jhwueng D.C., Boettiger C., and O'Meara B.C. 2012. Modeling stabilizing selection: Expanding the Ornstein-Uhlenbeck model of adaptive evolution. Evolution 66:2369-2383.</p>
<p>O'Meara B.C., Ane C., Sanderson P.C., Wainwright P.C. 2006. Testing for different rates of continuous trait evolution using likelihood. Evolution 60:922-933.</p>
<p>Butler M.A., King A.A. 2004. Phylogenetic comparative analysis: A modeling approach for adaptive evolution. American Naturalist 164:683-695.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeremy M. Beaulieu</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tworegime</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##First step is estimate parameters under a particular model:</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="OUwie.html">OUwie</a></span><span class="op">(</span><span class="va">tree</span>,<span class="va">trait</span>,model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OUMV"</span><span class="op">)</span>,root.station<span class="op">=</span><span class="cn">FALSE</span>, algorithm<span class="op">=</span><span class="st">"three.point"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The supplied regime painting may be unidentifiable for the regime painting. All regimes form connected subtrees.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Begin thorough search... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Summarizing results. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Second step is to run bootstrap replicates:</span></span></span>
<span class="r-in"><span><span class="va">boot.reps</span> <span class="op">&lt;-</span> <span class="fu">OUwie.boot</span><span class="op">(</span><span class="va">tree</span>,<span class="va">trait</span>,model<span class="op">=</span><span class="st">"OUMV"</span>, nboot<span class="op">=</span><span class="fl">10</span>, alpha<span class="op">=</span><span class="va">pp</span><span class="op">$</span><span class="va">solution</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, </span></span>
<span class="r-in"><span>sigma.sq<span class="op">=</span><span class="va">pp</span><span class="op">$</span><span class="va">solution</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,theta<span class="op">=</span><span class="va">pp</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, theta0<span class="op">=</span><span class="va">pp</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>algorithm<span class="op">=</span><span class="st">"three.point"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beginning parametric bootstrap -- performing 10 replicates </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Finally summarize to obtain the desired confidence -- here is the 95% CI:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">boot.reps</span>, <span class="fl">2</span>, <span class="va">quantile</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        alpha_1  alpha_2 sigma.sq_1 sigma.sq_2  theta_1   theta_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.5%  0.433825 0.433825 0.06695211  0.2323940 1.489816 0.1946057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97.5% 1.231032 1.231032 0.15807099  0.4988304 1.784805 0.9937171</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

